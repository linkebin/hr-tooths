<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>信息列表查询</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../../Styles/themes/default/style.css" media="all">
    <link rel="stylesheet" href="../../../Styles/themes/default/cover-style.css" media="all">
    
</head>
<body>


<!--条件搜索 start-->
<div class="eui-form eui-form-search eui-margin10">
    <!-- 查询重置按钮-->
    <!--<div class="eui-btn-group">-->
    <!--<button class="eui-btn">查询</button>-->
    <!--<button class="eui-btn eui-btn-primary">重置</button>-->
    <!--</div>-->

    <!--华丽的分割线-->
    <div class="eui-form-item item-colspan2">
        <label class="eui-form-label">年份：</label>
        <div class="eui-input-block">
            <input type="text" class="eui-input" id="dateTest" placeholder="选择年份">
        </div>
    </div>
    <div class="clearfix"></div>
</div>


<!--条件搜索 end-->

<div class="eui-margin10 ">
    <div class="eui-row">
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m1">
                <img src="../../../Styles/images/huaren/1.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m1b" data-value="1"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m2">
                <img src="../../../Styles/images/huaren/2.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m2b" data-value="2"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m3">
                <img src="../../../Styles/images/huaren/3.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m3b" data-value="3"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m4">
                <img src="../../../Styles/images/huaren/4.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m4b" data-value="4"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
    </div>
    <div class="eui-row">
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m5">
                <img src="../../../Styles/images/huaren/5.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m5b" data-value="5"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m6">
                <img src="../../../Styles/images/huaren/6.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m6b" data-value="6"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m7">
                <img src="../../../Styles/images/huaren/7.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m7b" data-value="7"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m8">
                <img src="../../../Styles/images/huaren/8.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" data-value="8"
                            data-method="addScheduling" id="m8b">设置排班
                    </button>
                </p>
            </div>
        </div>
    </div>
    <div class="eui-row">
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m9">
                <img src="../../../Styles/images/huaren/9.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m9b" data-value="9"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img " id="m10">
                <img src="../../../Styles/images/huaren/10.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m10b" data-value="10"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img" id="m11">
                <img src="../../../Styles/images/huaren/11.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" data-value="11" id="m11b"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
        <div class="eui-col-md3 ">
            <div class="eui-tab-card eui-margin20 eui-padding5 scheduling-img" id="m12">
                <img src="../../../Styles/images/huaren/12.jpg" alt="">
                <p class="eui-textAlignC eui-marginT10">
                    <button type="button" class="eui-btn eui-btn-normal eui-btn-small" id="m12b" data-value="12"
                            data-method="addScheduling">设置排班
                    </button>
                </p>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript" src="../../../Scripts/jquery-1.9.0.min.js"></script>
<script src="../../../Scripts/config.js" type="text/javascript"></script>
<script src="../../../Scripts/pack.ajax.js" type="text/javascript"></script>
<script src="../../../Scripts/module/eui.js" charset="utf-8"></script>
<script>
    var year = new Date().getFullYear();
    eui.use(['element', 'layedit', 'laydate'], function () {
        var element = eui.element
            , layer = eui.layer
            , laydate = eui.laydate

        //日期选择
        laydate.render({
            elem: '#dateTest'
            , type: 'year'
            , min: '2018-1-1 00:00:00'
            , value: new Date()
            , done: function (value, date, endDate) {
                changeYear(value);
            }
        });
        var active = {
            addScheduling: function (othis) {
                var month = othis.attr("data-value");
                var tit = "查看排班";
                if (isM(month)){
                    tit = "设置排班";
                }
                layer.open({
                    type: 2,
                    title:tit,
                    shadeClose: true,
                    shade: 0.3,
                    maxmin: true, //开启最大化最小化按钮
                    area: ['90%', '90%'],
                    content: 'doctors-scheduling-info.html?year='+year+"&month="+month
                });
            }
        };
        $('.eui-btn').on('click', function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
        //初始化计划
        initPlan(year);
    });
    //切换年份
    function changeYear(value) {
        for (var i = 1; i < 13; i++) {
            $("#m" + i)[0].style.border = "2px solid red";
            $("#m" + i + "b").text("设置排班");
            $("#m" + i + "b").attr("data-value",i);
        }
        year = value;
        initPlan(value)
    }

    //加载计划
    function initPlan(year) {
        $.ajax({
            type: "POST",
            url: basePath + "/scheduling/history/list",
            data: {
                year: year
            },
            dataType: 'json',
            success: function (result, status, xhr) {
                var list = result.data;
                for (var i = 0; i < list.length; i++) {
                    $("#m" + list[i].month)[0].style.border = "0px solid red";
                    $("#m" + list[i].month + "b").text("查看");
                    $("#m" + list[i].month + "b").attr("data-value",list[i].month+"|"+list[i].id);
                }
            },
            error: function () {
                console.log("加载失败");
            }
        });
    }

    function isM(m) {
        if (m == 1 || m == 2 || m == 3 || m == 4 || m == 5 || m == 6 || m == 7 || m == 8 || m == 9 || m == 10 || m == 11 || m == 12) {
            return true;
        } else {
            return false;
        }
    }

    function flushInit() {
        layer.msg('保存成功!',
            {
            icon: 1,
            time: 2000 //2秒关闭（如果不配置，默认是3秒）
            },
            function(){
            window.location.reload();
        });
    }
</script>

</body>
</html>
